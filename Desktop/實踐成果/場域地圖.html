<section id="Section_Activity_Region">
    <div id="activityRegionContainer">
        <h1 id="activityRegionTitle" class="activity-region-title animate__animated animate__jello">場 域 地 圖</h1>
        <h1 id="activityRegionSubTitle" class="activity-region-sub-title animate__animated animate__jello">TAIWAN</h1>
        <div id="taiwanSection">
            <div class="rectangle"></div>
        </div>
        <img id="imageWave" src="https://osausr.ntut.edu.tw/var/file/1/1001/img/3357/146602374.png" />
        <div id="activityRegionContentContainer">
            <span id="activityRegionContentTitleBorder"></span>
            <div class="d-flex align-items-center mb-3">
                <p id="activityRegionContentTitle">台北</p>
                <span id="activityRegionContentLable" class="label-usr">USR office</span>
            </div>
            <p id="activityRegionContent">北科 社會責任辦公室</p>
            <p id="activityRegionContentDate">Since 2018</p>
        </div>
        <img id="activityRegionIcon" alt="計畫圖片" class="d-none">
    </div>
    <div>
        <div id="cloneTemplate" class="d-none">
            <img class="icon-location" onclick="openPage(this)" data-aos="zoom-in-up" data-aos-duration="1000" />
        </div>
    </div>
</section>

<style type="text/css">
    #activityRegionContainer {
        position: relative;
        background-image: linear-gradient(to bottom, #ccf1fd, var(--white) 71%);
        height: 845px;
    }

    #imageWave {
        position: absolute;
        bottom: 0;
    }

    #taiwanSection {
        height: 737.6px;
        background: url(https://osausr.ntut.edu.tw/var/file/1/1001/img/3357/416460590.png);
        background-size: 100%;
        background-repeat: no-repeat;
        position: absolute;
        width: 600px;
        right: 21%;
        top: 13%;
        z-index: 99;
    }

    #activityRegionTitle {
        position: absolute;
        color: #4998b2;
        font-size: 45px;
        line-height: 1.33;
        left: 10%;
        top: 13%;
        z-index: 100;
    }

    #activityRegionSubTitle {
        position: absolute;
        font-size: 35px;
        color: #999999;
        left: 10%;
        top: 20%;
        z-index: 100;
    }

    #activityRegionContentContainer {
        position: absolute;
        font-size: 25px;
        top: 45%;
        left: 30%;
        letter-spacing: 2.5px;
        z-index: 200;
    }

    #activityRegionContentTitleBorder {
        position: absolute;
        width: 60px;
        height: 21px;
        top: 20px;
        left: 0;
        border-bottom: solid 2px #c0c0c0;
        border-right: solid 2px #c0c0c0;
    }

    #activityRegionContentTitle {
        color: #5e5e5e;
    }

    #activityRegionContentLable {
        cursor: pointer;
        padding: 1px 17px 5px;
        border-radius: 9px;
        font-size: 25px;
        color: white;
        line-height: 1.32;
        letter-spacing: 2.5px;
        margin-left: 20px;
    }

    #activityRegionContent {
        color: #424242;
        margin-bottom: 3px;
    }

    #activityRegionContentDate {
        letter-spacing: 2px;
        font-size: 20px;
        color: #858585;
    }

    #activityRegionIcon {
        position: absolute;
    }

    .rectangle {
        position: absolute;
        top: 25px;
        left: -25px;
        width: 158px;
        height: 158px;
        opacity: 0.27;
        border-radius: 15px;
        border: solid 1px #707070;
    }

    .icon-location {
        cursor: pointer;
        position: absolute;
        width: 35px;
        z-index: 100;
    }

    .label-usr {
        background-color: #4998b2;
    }

    .label-attachment {
        background-color: #ff4967;
    }

    .label-hub {
        background-color: #ffa747;
    }

    @media(max-width: 1024px) {
        #activityRegionContainer {
            height: 950px;
        }

        #taiwanSection {
            top: 35%;
            right: 10%;
        }

        #activityRegionContentContainer {
            top: 65%;
            left: 10%;
        }

        #activityRegionIcon {
            bottom: 2% !important;
            width: 30%;
        }
    }

    @media(max-width: 767px) {
        #activityRegionContainer {
            height: 1200px;
        }

        #activityRegionContentContainer {
            top: auto;
            left: auto;
            right: 3%;
            bottom: 3%;
        }
    }
</style>

<script>
    $(function () {
        createLocationIcons();
    });

    // 產生場域地圖之地標
    function createLocationIcons() {
        const locationIcons = [
            "https://osausr.ntut.edu.tw/var/file/1/1001/img/3357/181495897.png",
            "https://osausr.ntut.edu.tw/var/file/1/1001/img/3357/914330304.png",
            "https://osausr.ntut.edu.tw/var/file/1/1001/img/3357/112303707.png",
        ]
        activityRegionData.forEach((project) => {
            const icon = $('#cloneTemplate').find('.icon-location').clone();
            icon.data(project);
            icon.css("top", `${project.position[0]}%`);
            icon.css("left", `${project.position[1]}%`);
            icon.attr('src', locationIcons[project.labelType]);
            $('#taiwanSection').append(icon);
        });
        setIconsHover();
    }

    // 設定 Icon hover 事件
    function setIconsHover() {
        $('.icon-location').hover((el) => {
            const data = $(el.target).data();
            $(el.target).addClass('animate__animated animate__jello');
            setActivityRegionContent(data);
            showProjectIcon(data);
        }, (el) => {
            $(el.target).removeClass('animate__animated animate__jello');
        });
    }

    // 顯示計畫 Icon
    function showProjectIcon(data) {
        if (!data.iconUrl) {
            $('#activityRegionIcon').addClass('d-none');
        } else {
            $('#activityRegionIcon').removeClass('d-none');
            $('#activityRegionIcon').attr('src', data.iconUrl);
            $('#activityRegionIcon').css("bottom", `${data.iconPosition[0]}%`);
            $('#activityRegionIcon').css("left", `${data.iconPosition[1]}%`);
        }
    }

    // 顯示地標詳細資訊
    function setActivityRegionContent(data) {
        const labels = [
            {
                title: 'USR office',
                labelClass: 'label-usr',
            },
            {
                title: 'USR 附冊',
                labelClass: 'label-attachment',
            },
            {
                title: 'USR HUB',
                labelClass: 'label-hub',
            }
        ]
        $('#activityRegionContentTitle').text(data.location || '台北');
        $('#activityRegionContentLable').text(labels[data.labelType].title);
        $("#activityRegionContentLable").removeClass();
        $("#activityRegionContentLable").addClass(labels[data.labelType].labelClass);
        $('#activityRegionContent').text(data.title || '北科 社會責任辦公室');
        $('#activityRegionContentDate').text(data.date || 'Since 2018');
    }

    // 開啟合作團隊頁面連結
    function openPage(el) {
        const link = $(el).data().url;
        link ? window.open(link) : null;
    }
</script>